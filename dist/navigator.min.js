"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"function"==typeof define&&define.amd?define(["zepto"],t):t(Zepto)}(function(t){var n=function n(i,e){this.options=t.extend({},n.defaults,e),this.$element=t(i),this.init()};n.pluginName="thsH5Navigator",n.dataName="thsH5NavigatorData",n.version="1.0.0",n.defaults={openDebug:!0,title:document.title,titleAlign:"center",backgroundColor:"#e83031",autoHideNavArea:".header-img",showRightNav:!0,rightNavIcon:"share",clickLeftNavCallback:null,clickRightNavCallback:function(){}},n.prototype={init:function(){var n=this;this.debug("==== 导航栏插件开始初始化 ===="),this.$element.html('\n        <div class="nav-bg"></div>\n        <div class="nav">\n          <div class="back"><i class="iconfont icon-back"></i></div>\n          <div class="title '+this.options.titleAlign+'"><p class="inner"><span class="text">'+this.options.title+"</span></p></div>\n          "+(this.options.showRightNav?'<div class="other"><i class="iconfont icon-'+this.options.rightNavIcon+'"></i></div>':"")+"\n        </div>\n      "),this.$element.find(".nav-bg").css("background-color",this.options.backgroundColor),this.scrollTitle();var i=0;if(this.$element.on("click",function(){var e=(new Date).getTime();e-i<400?(n.debug("触发了导航双击事件"),i=0,n.scrollToTop({element:t(window),toT:0,durTime:300,delay:30,callback:null})):i=e}),this.$element.find(".back").on("click",function(){n.debug("触发了导航最左边图标的点击事件"),n.options.clickLeftNavCallback&&"function"==typeof n.options.clickLeftNavCallback?n.options.clickLeftNavCallback.apply(n):history.back()}),this.options.showRightNav&&this.$element.find(".other").on("click",function(){n.debug("触发了导航最右边图标的点击事件"),n.options.clickRightNavCallback&&"function"==typeof n.options.clickRightNavCallback&&n.options.clickRightNavCallback.apply(n)}),this.options.autoHideNavArea){var e=this.options.autoHideNavArea.split(",").filter(function(n){return t(n).length>0}),o=function(){var i=n.$element.height(),o=t(window).scrollTop(),a=null;if(e.some(function(n){var i=t(n);return!(!i||!i.offset())&&(i.offset().top-o<=0&&i.offset().top+i.offset().height>o&&(a=i,!0))})){t("body").css("padding-top","0");var l=(a.offset().top+a.offset().height+40-i-o)/a.offset().height;l>1&&(l=1),l<0&&(l=0),n.$element.find(".nav-bg").css("opacity",1-l)}};o(),t(window).on("scroll",function(){o()})}},debug:function(){this.options.openDebug&&console.log.apply(this,arguments)},scrollToTop:function(n){var i={element:t(window),toT:0,durTime:500,delay:30,callback:null},e=t.extend(i,n),o=null,a=e.element,l=a.scrollTop(),c=e.toT-l,s=0,f=Math.round(e.durTime/e.delay),u=function(t){s++;var n=Math.round(c/f);if(s>=f)return document.documentElement.scrollTop=t,window.clearInterval(o),void(e.callback&&"function"==typeof e.callback&&e.callback());document.documentElement.scrollTop=l+s*n};o=window.setInterval(function(){u(e.toT)},e.delay)},scrollTitle:function(){var t=this,n=this.$element.find(".title").width();if(this.$element.find(".title .inner .text").width()>n){var i=this.$element.find(".title .inner");i.append(i.html());var e=this.$element.find(".title .inner .text"),o=e.eq(0).width(),a=0;setTimeout(function(){t.titleTimer=setInterval(function(){a+=1,e.css("left",-a),a>o&&(a=0)},60)},3e3)}}};var i=t.fn[n.pluginName];t.fn[n.pluginName]=function(i){return this.each(function(){var e=t(this),o=t.fn[n.pluginName].pluginData[e.data(n.dataName)],a="object"==(void 0===i?"undefined":_typeof(i))&&i;o||(t.fn[n.pluginName].pluginData[++t.fn[n.pluginName].pluginData.index]=new n(this,a),e.data(n.dataName,t.fn[n.pluginName].pluginData.index),o=t.fn[n.pluginName].pluginData[e.data(n.dataName)]),"string"==typeof i&&o[i]()})},t.fn[n.pluginName].pluginData={index:0},t.fn[n.pluginName].Constructor=n,t.fn[n.pluginName].noConflict=function(){return t.fn[n.pluginName]=i,this},t(document).ready(function(){t('<div data-role="'+n.pluginName+'">').addClass("navigator").appendTo("body"),t('[data-role="'+n.pluginName+'"]').each(function(){var i=t(this),e=t.fn[n.pluginName].pluginData[i.data(n.dataName)];t.fn[n.pluginName].call(i,e)})})});